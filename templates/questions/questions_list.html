{% extends 'core/base.html' %}
{% block main %}
	<div class="questions-container">

		<ul class="questions-list" id="questions-list">
			{% for question in questions %}
				<li class="question-item">
					<h2 class="question-title">{{ question.title }}</h2>
					<p class="question-body">{{ question.body }}</p>
					{% if question.tags.all %}
						<div><strong>Tags:</strong> {{ question.tags.all|join:', ' }}</div>
					{% endif %}
					{% if question.author.pk == request.user.pk %}
						<div class="question-actions">
							<a class="btn btn-edit" href="{% url 'question_update' question.pk %}">Edit</a>
							<a class="btn btn-delete" href="{% url 'question_delete' question.pk %}">Delete</a>
						</div>
					{% endif %}
				</li>
			{% empty %}
				<li class="no-questions">No questions found.</li>
			{% endfor %}
		</ul>


		{% if is_paginated %}
			<nav class="pagination" aria-label="Questions pagination">

				<ul class="pagination-links">
					{% if not page_obj.has_previous %}
						<li class="disabled">First</li>
					{% else %}
						<li><a href="?page=1" aria-label="First page">First</a></li>
					{% endif %}

					{% if page_obj.has_previous %}
						<li><a href="?page={{ page_obj.previous_page_number }}" aria-label="Previous page">Previous</a></li>
					{% else %}
						<li class="disabled">Previous</li>
					{% endif %}

					<li class="current-page" aria-current="page">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</li>

					{% if page_obj.has_next %}
						<li><a href="?page={{ page_obj.next_page_number }}" aria-label="Next page">Next</a></li>
					{% else %}
						<li class="disabled">Next</li>
					{% endif %}

					{% if not page_obj.has_next %}
						<li class="disabled">Last</li>
					{% else %}
						<li><a href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last page">Last</a></li>
					{% endif %}
				</ul>

				<form id="pageJumpForm" method="get" action="" class="page-jump-form" aria-label="Jump to page form">
					<label for="page_number" class="page-jump-label">Go to page:</label>
					<input
							type="number"
							id="page_number"
							name="page"
							value="{{ page_obj.number }}"
							required
							class="page-jump-input"
							aria-describedby="pageJumpHelp"
					>
					<button type="submit" class="btn btn-go">Go</button>
					<small id="pageJumpHelp" class="form-help-text">Enter a page number between 1 and {{ page_obj.paginator.num_pages }}</small>
				</form>

			</nav>

			<script>
				document.getElementById('pageJumpForm').addEventListener('submit', function(e) {
					const input = document.getElementById('page_number');
					const maxPage = {{ page_obj.paginator.num_pages }};
					let val = parseInt(input.value, 10);

					if (val > maxPage) {
						input.value = maxPage;
					}
					if (val < 1 || isNaN(val)) {
						input.value = 1;
					}
				});
			</script>

		{% endif %}

	</div>
{% endblock %}
